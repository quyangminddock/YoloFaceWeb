<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenSeeFace Web - 虚拟形象动画工作室</title>
    <meta name="description" content="现代化的面部追踪虚拟形象系统，让视频创作更有趣">
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <!-- 背景动画 -->
    <div class="bg-animation">
        <div class="floating-shape shape-1"></div>
        <div class="floating-shape shape-2"></div>
        <div class="floating-shape shape-3"></div>
    </div>

    <!-- 主容器 -->
    <div class="app-container">
        <!-- 顶部导航 -->
        <header class="header">
            <div class="logo">
                <span class="logo-icon">🎭</span>
                <span class="logo-text">OpenSeeFace Web</span>
            </div>
            <div class="nav-actions">
                <button class="btn btn-ghost" id="settingsBtn">
                    <span>⚙️</span> 设置
                </button>
                <button class="btn btn-primary" id="connectBtn">
                    <span class="status-dot"></span> 连接追踪器
                </button>
            </div>
        </header>

        <!-- 主内容区 -->
        <main class="main-content">
            <!-- 左侧面板 - 形象选择 -->
            <aside class="sidebar sidebar-left glass-panel">
                <h3 class="sidebar-title">
                    <span>🐱</span> 虚拟形象
                    <small style="display: block; font-size: 0.7em; opacity: 0.7; margin-top: 4px; font-weight: 400;">
                        可同时选择多个
                    </small>
                </h3>
                <div class="avatar-grid" id="avatarGrid">
                    <div class="avatar-item active" data-avatar="cat">
                        <div class="avatar-preview">🐱</div>
                        <span>小猫咪</span>
                    </div>
                    <div class="avatar-item" data-avatar="dog">
                        <div class="avatar-preview">🐶</div>
                        <span>小狗狗</span>
                    </div>
                    <div class="avatar-item" data-avatar="rabbit">
                        <div class="avatar-preview">🐰</div>
                        <span>小兔子</span>
                    </div>
                    <div class="avatar-item" data-avatar="panda">
                        <div class="avatar-preview">🐼</div>
                        <span>熊猫</span>
                    </div>
                    <div class="avatar-item" data-avatar="fox">
                        <div class="avatar-preview">🦊</div>
                        <span>小狐狸</span>
                    </div>
                    <div class="avatar-item" data-avatar="bear">
                        <div class="avatar-preview">🐻</div>
                        <span>小熊</span>
                    </div>
                </div>

                <h3 class="sidebar-title" style="margin-top: 2rem;">
                    <span>🎨</span> 背景主题
                </h3>
                <div class="theme-grid" id="themeGrid">
                    <div class="theme-item active" data-theme="gradient1">
                        <div class="theme-preview"
                            style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);"></div>
                    </div>
                    <div class="theme-item" data-theme="gradient2">
                        <div class="theme-preview"
                            style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);"></div>
                    </div>
                    <div class="theme-item" data-theme="gradient3">
                        <div class="theme-preview"
                            style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);"></div>
                    </div>
                    <div class="theme-item" data-theme="gradient4">
                        <div class="theme-preview"
                            style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);"></div>
                    </div>
                    <div class="theme-item" data-theme="gradient5">
                        <div class="theme-preview"
                            style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);"></div>
                    </div>
                    <div class="theme-item" data-theme="solid">
                        <div class="theme-preview" style="background: #1a1a2e;"></div>
                    </div>
                </div>
            </aside>

            <!-- 中央画布区域 -->
            <section class="canvas-wrapper">
                <div class="canvas-container glass-panel" id="canvasContainer">
                    <canvas id="mainCanvas"></canvas>

                    <!-- 状态指示器 -->
                    <div class="canvas-overlay">
                        <div class="connection-status" id="connectionStatus">
                            <span class="status-icon">📡</span>
                            <span class="status-text">等待连接...</span>
                        </div>
                    </div>

                    <!-- 表情检测显示 -->
                    <div class="expression-display" id="expressionDisplay">
                        <div class="expression-item">
                            <span class="expression-label">眨眼</span>
                            <div class="expression-bar">
                                <div class="expression-fill" id="blinkBar" style="width: 0%"></div>
                            </div>
                        </div>
                        <div class="expression-item">
                            <span class="expression-label">微笑</span>
                            <div class="expression-bar">
                                <div class="expression-fill" id="smileBar" style="width: 0%"></div>
                            </div>
                        </div>
                        <div class="expression-item">
                            <span class="expression-label">张嘴</span>
                            <div class="expression-bar">
                                <div class="expression-fill" id="mouthBar" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>

                    <!-- OpenSeeFace 3D 姿态显示 (仅OpenSeeFace模式) -->
                    <div class="openseeface-panel" id="openSeeFacePanel">
                        <div class="panel-title">🎯 OpenSeeFace 3D 追踪</div>
                        <div class="pose-data">
                            <div class="pose-item">
                                <span class="pose-label">Pitch (俯仰)</span>
                                <span class="pose-value" id="pitchValue">0°</span>
                            </div>
                            <div class="pose-item">
                                <span class="pose-label">Yaw (偏航)</span>
                                <span class="pose-value" id="yawValue">0°</span>
                            </div>
                            <div class="pose-item">
                                <span class="pose-label">Roll (翻滚)</span>
                                <span class="pose-value" id="rollValue">0°</span>
                            </div>
                            <div class="pose-item">
                                <span class="pose-label">追踪质量</span>
                                <span class="pose-value" id="qualityValue">--</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 控制栏 -->
                <div class="controls-bar glass-panel">
                    <div class="controls-left">
                        <button class="control-btn" id="cameraBtn" title="浏览器摄像头">
                            <span>📷</span>
                            <span class="btn-label">摄像头</span>
                        </button>
                        <button class="control-btn" id="demoBtn" title="演示模式">
                            <span>🎬</span>
                            <span class="btn-label">演示</span>
                        </button>
                        <button class="control-btn" id="mirrorBtn" title="镜像翻转">
                            <span>🪞</span>
                            <span class="btn-label">镜像</span>
                        </button>
                        <button class="control-btn" id="showLandmarksBtn" title="显示关键点">
                            <span>👁️</span>
                            <span class="btn-label">关键点</span>
                        </button>
                    </div>
                    <div class="controls-center">
                        <button class="control-btn record-btn" id="recordBtn" title="开始录制">
                            <span class="record-icon">⏺️</span>
                            <span class="btn-label">录制</span>
                        </button>
                        <button class="control-btn" id="screenshotBtn" title="截图">
                            <span>📸</span>
                            <span class="btn-label">截图</span>
                        </button>
                        <button class="control-btn" id="gifBtn" title="生成GIF">
                            <span>🎞️</span>
                            <span class="btn-label">GIF</span>
                        </button>
                    </div>
                    <div class="controls-right">
                        <button class="control-btn" id="fullscreenBtn" title="全屏">
                            <span>⛶</span>
                            <span class="btn-label">全屏</span>
                        </button>
                    </div>
                </div>
            </section>

            <!-- 右侧面板 - 装饰和特效 -->
            <aside class="sidebar sidebar-right glass-panel">
                <h3 class="sidebar-title">
                    <span>✨</span> 装饰物
                </h3>
                <div class="decoration-grid" id="decorationGrid">
                    <div class="decoration-item" data-decoration="none">
                        <span>❌</span>
                        <span>无</span>
                    </div>
                    <div class="decoration-item" data-decoration="glasses">
                        <span>👓</span>
                        <span>眼镜</span>
                    </div>
                    <div class="decoration-item" data-decoration="sunglasses">
                        <span>🕶️</span>
                        <span>墨镜</span>
                    </div>
                    <div class="decoration-item" data-decoration="hat">
                        <span>🎩</span>
                        <span>礼帽</span>
                    </div>
                    <div class="decoration-item" data-decoration="crown">
                        <span>👑</span>
                        <span>皇冠</span>
                    </div>
                    <div class="decoration-item" data-decoration="hearts">
                        <span>💕</span>
                        <span>爱心</span>
                    </div>
                    <div class="decoration-item" data-decoration="stars">
                        <span>⭐</span>
                        <span>星星</span>
                    </div>
                    <div class="decoration-item" data-decoration="sparkles">
                        <span>✨</span>
                        <span>闪烁</span>
                    </div>
                </div>

                <h3 class="sidebar-title" style="margin-top: 2rem;">
                    <span>🎭</span> 特效滤镜
                </h3>
                <div class="effect-list" id="effectList">
                    <div class="effect-item" data-effect="none">
                        <span class="effect-icon">🚫</span>
                        <span class="effect-name">无特效</span>
                    </div>
                    <div class="effect-item" data-effect="glow">
                        <span class="effect-icon">💫</span>
                        <span class="effect-name">发光效果</span>
                    </div>
                    <div class="effect-item" data-effect="rainbow">
                        <span class="effect-icon">🌈</span>
                        <span class="effect-name">彩虹光晕</span>
                    </div>
                    <div class="effect-item" data-effect="pixelate">
                        <span class="effect-icon">🟩</span>
                        <span class="effect-name">像素化</span>
                    </div>
                    <div class="effect-item" data-effect="neon">
                        <span class="effect-icon">💜</span>
                        <span class="effect-name">霓虹灯</span>
                    </div>
                </div>

                <!-- 表情触发器 -->
                <h3 class="sidebar-title" style="margin-top: 2rem;">
                    <span>😄</span> 表情触发
                </h3>
                <div class="trigger-list" id="triggerList">
                    <label class="trigger-item">
                        <input type="checkbox" id="triggerSmile" checked>
                        <span>微笑时显示爱心 💕</span>
                    </label>
                    <label class="trigger-item">
                        <input type="checkbox" id="triggerBlink" checked>
                        <span>眨眼时闪烁星星 ⭐</span>
                    </label>
                    <label class="trigger-item">
                        <input type="checkbox" id="triggerMouth">
                        <span>张嘴时播放音效 🔊</span>
                    </label>
                </div>
            </aside>
        </main>

        <!-- 底部状态栏 -->
        <footer class="footer glass-panel">
            <div class="footer-left">
                <span class="fps-counter" id="fpsCounter">FPS: --</span>
                <span class="separator">|</span>
                <span class="tracking-info" id="trackingInfo">追踪: 未检测到面部</span>
            </div>
            <div class="footer-center">
                <span id="recordingTime" class="recording-time hidden">⏺️ 00:00:00</span>
            </div>
            <div class="footer-right">
                <span>OpenSeeFace Web v1.0</span>
            </div>
        </footer>
    </div>

    <!-- 设置弹窗 -->
    <div class="modal" id="settingsModal">
        <div class="modal-content glass-panel">
            <div class="modal-header">
                <h2>⚙️ 设置</h2>
                <button class="modal-close" id="closeSettings">&times;</button>
            </div>
            <div class="modal-body">
                <div class="setting-group">
                    <label>WebSocket 服务器地址</label>
                    <input type="text" id="wsAddress" value="ws://localhost:8765" class="setting-input">
                </div>
                <div class="setting-group">
                    <label>画布分辨率</label>
                    <select id="resolution" class="setting-input">
                        <option value="720">720p (1280x720)</option>
                        <option value="1080" selected>1080p (1920x1080)</option>
                        <option value="480">480p (854x480)</option>
                    </select>
                </div>
                <div class="setting-group">
                    <label>录制格式</label>
                    <select id="recordFormat" class="setting-input">
                        <option value="webm">WebM (推荐)</option>
                        <option value="mp4">MP4</option>
                    </select>
                </div>
                <div class="setting-group">
                    <label>形象平滑度</label>
                    <input type="range" id="smoothness" min="0" max="100" value="50" class="setting-range">
                    <span id="smoothnessValue">50%</span>
                </div>
                <div class="setting-group">
                    <label>摄像头视频透明度</label>
                    <input type="range" id="videoOpacity" min="0" max="100" value="30" class="setting-range">
                    <span id="videoOpacityValue">30%</span>
                </div>
                <div class="setting-group">
                    <label>
                        <input type="checkbox" id="autoConnect" checked>
                        自动连接
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="resetSettings">恢复默认</button>
                <button class="btn btn-primary" id="saveSettings">保存设置</button>
            </div>
        </div>
    </div>

    <!-- Toast 通知 -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- 脚本 -->
    <script src="js/faceRenderer.js"></script>
    <script src="js/avatar.js"></script>
    <script src="js/effects.js"></script>
    <script src="js/recorder.js"></script>
    <script src="js/cameraTracker.js"></script>
    <script src="js/app.js"></script>
</body>

</html>